<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Nathan's Year One | The Big One</title>
    <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;600&family=Outfit:wght@300;400;600&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    
    <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-database-compat.js"></script>

    <style>
        :root {
            --coco-gradient: linear-gradient(135deg, #a8e063 0%, #20e3b2 100%);
            --modern-purple-blue: linear-gradient(135deg, #6366f1 0%, #a855f7 100%);
            --glass-bg: rgba(255, 255, 255, 0.85);
            --film-black: #2d3436;
            --c-red: #ff4d4d; --c-orange: #ff9f43; --c-yellow: #feca57; --c-green: #2ecc71; --c-blue: #48dbfb;
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body { 
            margin: 0; font-family: 'Outfit', sans-serif; 
            background: var(--coco-gradient); background-attachment: fixed; 
            overflow-x: hidden; color: #2d3436; 
        }

        /* --- NAVBAR --- */
        nav {
            position: sticky; top: 0; background: rgba(255, 255, 255, 0.7); backdrop-filter: blur(15px);
            padding: 12px 20px; display: flex; align-items: center; justify-content: center; z-index: 1000; 
            border-bottom: 2px solid rgba(255,255,255,0.4);
        }
        .coco-text { font-family: 'Fredoka', sans-serif; font-size: 1.5rem; font-weight: 600; }
        .coco-text span:nth-child(1) { color: var(--c-red); }
        .coco-text span:nth-child(2) { color: var(--c-orange); }
        .coco-text span:nth-child(3) { color: var(--c-yellow); }
        .coco-text span:nth-child(4) { color: var(--c-green); }
        .coco-text span:nth-child(5) { color: var(--c-blue); }
        .coco-text span:nth-child(6) { color: var(--c-red); }
        .coco-text span:nth-child(7) { color: var(--c-orange); }
        .coco-text span:nth-child(8) { color: var(--c-green); }
        .coco-text span:nth-child(9) { color: var(--c-blue); }

        /* --- HERO --- */
        .hero { padding: 40px 20px; text-align: center; }
        .floating-logo { width: 140px; margin: 0 auto 15px; animation: float 4s ease-in-out infinite; filter: drop-shadow(0 10px 15px rgba(0,0,0,0.1)); }
        .floating-logo img { width: 100%; }
        h1 { font-family: 'Fredoka'; color: white; font-size: 2.5rem; margin: 0; text-shadow: 0 4px 10px rgba(0,0,0,0.1); }
        .hero-details { background: rgba(255,255,255,0.2); display: inline-block; padding: 8px 20px; border-radius: 50px; color: white; margin-top: 15px; font-weight: 400; backdrop-filter: blur(5px); }

        /* --- COUNTDOWN --- */
        .countdown { display: flex; justify-content: center; gap: 10px; margin: 25px 0; }
        .count-box { background: white; padding: 10px; border-radius: 12px; min-width: 65px; box-shadow: 0 8px 15px rgba(0,0,0,0.05); }
        .count-num { display: block; font-size: 1.3rem; font-weight: 600; color: #6366f1; font-family: 'Fredoka'; }
        .count-lab { font-size: 0.6rem; text-transform: uppercase; color: #999; }

        /* --- FILM GALLERY --- */
        .gallery-container { position: relative; width: 100%; padding: 60px 0; overflow: hidden; }
        .gallery-container::before { content: ''; position: absolute; top: 75px; left: -10%; width: 120%; height: 2px; background: rgba(0,0,0,0.1); z-index: 1; }
        .slider-track { display: flex; align-items: flex-start; transition: transform 0.6s cubic-bezier(0.25, 1, 0.5, 1); padding: 0 10%; }
        
        .slide { min-width: 85%; margin: 0 15px; transition: all 0.6s ease; filter: blur(4px) grayscale(0.5); opacity: 0.4; transform: scale(0.8); position: relative; z-index: 2; }
        .slide.active { filter: blur(0) grayscale(0); opacity: 1; transform: scale(1); animation: activeSwing 3s ease-in-out infinite; }
        
        /* Film Frame: Solid Bottom for Description */
        .film-frame { 
            background: var(--film-black); 
            padding: 45px 15px 35px 15px; 
            border-radius: 8px; 
            box-shadow: 0 25px 50px rgba(0,0,0,0.4); 
            position: relative; 
            display: flex;
            flex-direction: column;
            width: 100%;
        }
        /* Film holes at TOP only */
        .film-frame::before { 
            content: ''; position: absolute; left: 0; width: 100%; height: 20px; 
            background-image: radial-gradient(circle, #fff 40%, transparent 45%); 
            background-size: 30px 20px; z-index: 3; top: 12px;
        }
        
        .slide img { 
            width: 100%; 
            display: block; 
            border-radius: 4px; 
            aspect-ratio: 1; 
            object-fit: cover; 
            border: 2px solid #333;
            margin-bottom: 20px;
        }

        .frame-content {
            color: white;
            text-align: center;
            padding: 0 5px;
            word-wrap: break-word;
        }
        .frame-title { font-family: 'Fredoka'; font-size: 1.5rem; color: var(--c-yellow); margin-bottom: 8px; }
        .frame-desc { font-size: 1rem; line-height: 1.5; opacity: 0.95; font-weight: 300; }

        .hanging-point { position: absolute; top: -35px; left: 50%; transform: translateX(-50%); width: 2px; height: 40px; background: #555; }
        .hanging-point::after { content: 'ðŸ“Ž'; position: absolute; top: -12px; left: -10px; font-size: 20px; }

        /* --- CONTROLS --- */
        .controls { display: flex; justify-content: center; gap: 20px; margin: 10px 0 30px 0; }
        .nav-btn { background: var(--modern-purple-blue); color: white; border: none; width: 55px; height: 55px; border-radius: 50%; cursor: pointer; box-shadow: 0 8px 20px rgba(99,102,241,0.3); }

        /* --- MODERN ANONYMOUS SWITCH --- */
        .guestbook { background: rgba(255, 255, 255, 0.4); margin: 20px; padding: 30px; border-radius: 40px; border: 1px solid white; }
        
        .modern-switch {
            display: flex; align-items: center; gap: 12px; margin-bottom: 15px; cursor: pointer;
            background: rgba(255,255,255,0.5); padding: 10px 15px; border-radius: 50px; width: fit-content;
        }
        .modern-switch input { display: none; }
        .slider { width: 40px; height: 20px; background: #ccc; border-radius: 20px; position: relative; transition: .3s; }
        .slider::before { content: ""; position: absolute; height: 14px; width: 14px; left: 3px; bottom: 3px; background: white; border-radius: 50%; transition: .3s; }
        input:checked + .slider { background: var(--modern-purple-blue); }
        input:checked + .slider::before { transform: translateX(20px); }
        .switch-label { font-size: 0.9rem; font-weight: 600; color: #444; }

        /* --- GUESTBOOK INPUTS --- */
        input, textarea { width: 100%; padding: 15px; margin: 8px 0; border-radius: 18px; border: none; font-family: inherit; font-size: 1rem; }
        .btn-post { background: var(--modern-purple-blue); color: white; border: none; padding: 18px; border-radius: 20px; width: 100%; cursor: pointer; font-weight: 600; font-size: 1rem; }

        .vault-area { margin-top: 40px; border-top: 2px dashed rgba(255,255,255,0.5); padding-top: 25px; text-align: center; }
        .pw-field { max-width: 250px; text-align: center; background: rgba(255,255,255,0.8); }

        @keyframes float { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-20px); } }
        @keyframes activeSwing { 0%, 100% { transform: scale(1) rotate(-1.5deg); } 50% { transform: scale(1.03) rotate(1.5deg); } }
    </style>
</head>
<body>

    <nav>
        <div class="coco-text">
            <span>C</span><span>o</span><span>C</span><span>o</span><span>m</span><span>e</span><span>l</span><span>o</span><span>n</span>
        </div>
    </nav>

    <section class="hero">
        <div class="floating-logo"><img src="Cocomelon-Logo.png" alt="Logo"></div>
        <h1>THE BIG ONE</h1>
        <div class="hero-details">
            <i class="fas fa-calendar-star"></i> February 6, 2026 â€¢ Nathan's Special Day
        </div>
        
        <div class="countdown">
            <div class="count-box"><span class="count-num" id="days">00</span><span class="count-lab">Days</span></div>
            <div class="count-box"><span class="count-num" id="hours">00</span><span class="count-lab">Hrs</span></div>
            <div class="count-box"><span class="count-num" id="mins">00</span><span class="count-lab">Min</span></div>
        </div>
    </section>

    <div class="gallery-container" id="galleryContainer">
        <div class="slider-track" id="sliderTrack"></div>
    </div>

    <div class="controls">
        <button class="nav-btn" onclick="changeSlide(-1)"><i class="fas fa-chevron-left"></i></button>
        <button class="nav-btn" onclick="changeSlide(1)"><i class="fas fa-chevron-right"></i></button>
    </div>

    <section class="guestbook">
        <h3 style="text-align:center; font-family:'Fredoka'; color:#4c1d95; margin-top:0;">BEST WISHES</h3>
        
        <label class="modern-switch">
            <input type="checkbox" id="isAnon" onchange="toggleAnon()">
            <span class="slider"></span>
            <span class="switch-label">Post Anonymously</span>
        </label>

        <input type="text" id="vName" placeholder="Your Full Name">
        <textarea id="vMsg" rows="3" placeholder="Write a birthday message..."></textarea>
        <button class="btn-post" onclick="addPost()">POST MESSAGE</button>
        <div id="posts" style="margin-top:20px;"></div>
        
        <div class="vault-area">
            <p style="font-size:0.8rem; color:#666;">Admin Download Section</p>
            <input type="password" id="vPass" class="pw-field" placeholder="Enter Vault Password">
            <button class="btn-post" style="background:#444; margin-top:10px;" onclick="downloadPDF()">DOWNLOAD ALL AS PDF</button>
        </div>
    </section>

    <script>
        // --- FIREBASE CONFIGURATION ---
        const firebaseConfig = {
            apiKey: "AIzaSyCUxdS965zf_KhmWo7gA3rwpDNbahZaBb8",
            authDomain: "nathan-birthday-b5c96.firebaseapp.com",
            projectId: "nathan-birthday-b5c96",
            storageBucket: "nathan-birthday-b5c96.firebasestorage.app",
            messagingSenderId: "596124074832",
            appId: "1:596124074832:web:0166f445efdccd8b2b6255",
            databaseURL: "https://nathan-birthday-b5c96-default-rtdb.firebaseio.com"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const database = firebase.database();
        const wishesRef = database.ref('wishes');

        // --- COUNTDOWN LOGIC ---
        const target = new Date("February 6, 2026 00:00:00").getTime();
        function updateTimer() {
            const now = new Date().getTime();
            const gap = target - now;
            if (gap < 0) { document.querySelector('.countdown').innerHTML = "<h2>IT'S PARTY TIME! ðŸŽ‚</h2>"; return; }
            document.getElementById('days').innerText = Math.floor(gap / (1000 * 60 * 60 * 24)).toString().padStart(2, '0');
            document.getElementById('hours').innerText = Math.floor((gap % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60)).toString().padStart(2, '0');
            document.getElementById('mins').innerText = Math.floor((gap % (1000 * 60 * 60)) / (1000 * 60)).toString().padStart(2, '0');
        }
        setInterval(updateTimer, 1000); updateTimer();

        // --- GALLERY DATA ---
        const galleryData = [
            { title: "Newborn", desc: "Day 1: A star was born! You were so tiny and perfect.", img: "0.jpg" },
            { title: "1 Month", desc: "First smiles! Seeing your eyes light up changed our world.", img: "1.jpg" },
            { title: "2 Months", desc: "Discovering your hands and giggling at everything!", img: "2.jpg" },
            { title: "3 Months", desc: "Tummy time champion. You're getting so strong.", img: "3.jpg" },
            { title: "4 Months", desc: "Grabbing toys and finding your voice. Such a loud baby!", img: "4.jpg" },
            { title: "5 Months", desc: "Almost sitting up! You love watching the birds outside.", img: "5.jpg" },
            { title: "6 Months", desc: "Half a year! Your first taste of solid food was a hit.", img: "6.jpg" },
            { title: "7 Months", desc: "Sitting up tall and playing with your favorite Nathan toys.", img: "7.jpg" },
            { title: "8 Months", desc: "Crawling fast! No corner of the house is safe now.", img: "8.jpg" },
            { title: "9 Months", desc: "Pulling yourself up on the sofa. Standing tall!", img: "9.jpg" },
            { title: "10 Months", desc: "Waving 'Hi' and 'Bye'. You're such a social butterfly.", img: "10.jpg" },
            { title: "11 Months", desc: "Brave first steps. You are so determined and fearless.", img: "11.jpg" },
            { title: "ONE YEAR!", desc: "Happy 1st Birthday! Our first year together was magic.", img: "12.jpg" }
        ];

        const track = document.getElementById('sliderTrack');
        let wishes = [];

        galleryData.forEach((item, i) => {
            const slide = document.createElement('div');
            slide.className = `slide ${i === 0 ? 'active' : ''}`;
            slide.innerHTML = `
                <div class="hanging-point"></div>
                <div class="film-frame">
                    <img src="${item.img}" onerror="this.src='https://via.placeholder.com/600/333/fff?text=Photo+${i}'">
                    <div class="frame-content">
                        <div class="frame-title">${item.title}</div>
                        <div class="frame-desc">${item.desc}</div>
                    </div>
                </div>`;
            track.appendChild(slide);
        });

        let currentIdx = 0;
        const slides = document.querySelectorAll('.slide');

        function updateGallery() {
            const width = slides[0].offsetWidth + 30;
            track.style.transform = `translateX(${-currentIdx * width}px)`;
            slides.forEach((s, i) => s.classList.toggle('active', i === currentIdx));
        }

        function changeSlide(dir) {
            currentIdx = (currentIdx + dir + galleryData.length) % galleryData.length;
            updateGallery();
        }

        // --- GUESTBOOK FUNCTIONS ---
        function toggleAnon() {
            const field = document.getElementById('vName');
            const isChecked = document.getElementById('isAnon').checked;
            field.value = isChecked ? "Anonymous Guest" : "";
            field.disabled = isChecked;
        }

        function addPost() {
            const nameField = document.getElementById('vName'), msgField = document.getElementById('vMsg');
            let name = nameField.value.trim(), msg = msgField.value.trim();
            if(!name || !msg) { alert("Please fill everything!"); return; }

            // Save to Firebase
            const newPostRef = wishesRef.push();
            newPostRef.set({
                name: name,
                msg: msg,
                time: new Date().toLocaleString()
            }).then(() => {
                confetti({ particleCount: 150, spread: 70, origin: { y: 0.7 } });
                msgField.value = "";
                if(!document.getElementById('isAnon').checked) nameField.value = "";
            }).catch(err => alert("Error saving: " + err.message));
        }

        // Live Listener to fetch posts from Firebase
        wishesRef.on('value', (snapshot) => {
            const postsDiv = document.getElementById('posts');
            postsDiv.innerHTML = "";
            wishes = []; 
            snapshot.forEach((childSnapshot) => {
                const data = childSnapshot.val();
                wishes.push(data);
                const p = document.createElement('div');
                p.style.cssText = "background:white; padding:18px; border-radius:18px; margin-bottom:12px; border-left:6px solid #6366f1; box-shadow:0 4px 12px rgba(0,0,0,0.06);";
                p.innerHTML = `<strong>${data.name}:</strong> ${data.msg}<br><small style="color:#bbb">${data.time}</small>`;
                postsDiv.prepend(p);
            });
        });

        function downloadPDF() {
            if(document.getElementById('vPass').value !== "natoynakamahalmhal") { alert("Wrong Password"); return; }
            const { jsPDF } = window.jspdf; const doc = new jsPDF();
            doc.text("NATHAN'S BIG ONE - WISHES", 20, 20);
            let y = 35;
            wishes.forEach(w => {
                if(y > 270) { doc.addPage(); y = 20; }
                doc.text(`${w.time} - ${w.name}: ${w.msg}`, 20, y); y += 15;
            });
            doc.save("Wishes.pdf");
        }
        updateGallery();
    </script>
</body>
</html>